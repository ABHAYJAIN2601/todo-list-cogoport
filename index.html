<!DOCTYPE html>
<html>
<head>
<title>Page Title</title>
<link rel="stylesheet" href = './index.css'/>
</head>
  <body>
    <div class="todo-app">
        <h1 class="title">To-do list</h1>
        <p class="qoute">“Each day I will accomplish one thing on my to do list.”</p>
      <form class="input-section">
        <input id="todoInput" type="text" placeholder="Add item..." />
        <button id="addBtn" type="submit" class="add">Add</button>
      </form>
      <div class="todos">
        <ul class="todo-list">
        </ul>
      </div>
    </div>
  </body>
  <script>
    let todos = JSON.parse(localStorage.getItem("todos")) || [];
let editIndex = -1;
const todoForm = document.querySelector(".input-section");
const todoInput = document.querySelector("#todoInput");
const todoList = document.querySelector(".todo-list");
const addButton = document.querySelector("#addBtn");
const todo_main = document.querySelector(".todos");

function saveTodos() {
  localStorage.setItem("todos", JSON.stringify(todos));
}

function getData(){
    fetch('https://jsonplaceholder.typicode.com/todos').then((response)=>{
        if(!response.ok){
            throw new Error('error');
        }
        return response.json();
    }).then((data)=>{
        todos = data;
        saveTodos();
    }).catch((error)=>{
        console.loh(error);
    })
}

getData();

async function renderTodos() {
  todoList.innerHTML = "";

  todos.forEach((todo, index) => {
    const li = document.createElement("li");
    li.className = "li";
    li.setAttribute('id',index);
    const checkbox = document.createElement("input");
    checkbox.className = "form-check-input";
    checkbox.type = "checkbox";
    checkbox.checked = todo.completed;
    checkbox.addEventListener("change", () => toggleTodoCompleted(index));

    const label = document.createElement("label");
    label.className = "form-check-label";

    const spanText = document.createElement("span");
    spanText.className = "todo-text";
    spanText.textContent = todo.title;

    const deleteButton = document.createElement("span");
    deleteButton.className = "span-button";
    deleteButton.innerHTML = 'Delete';
    deleteButton.addEventListener("click", () => deleteTodo(index));


    li.appendChild(checkbox);
    li.appendChild(label);
    li.appendChild(spanText);
    li.appendChild(deleteButton);

    todoList.appendChild(li);
  });
}
function addTodo() {
  const todoText = todoInput.value.trim();

  if (todoText !== "") {
    if (editIndex === -1) {
      todos.unshift({
        title: todoText,
        completed: false,
        id: 0
      });
    } else {
      todos[editIndex].title = todoText;
      editIndex = -1;
      addButton.style.display = "inline";
    }

    saveTodos();
    renderTodos();
    todoInput.value = "";
  }

  return false;
}

function toggleTodoCompleted(index) {
  todos[index].completed = !todos[index].completed;
  saveTodos();
  renderTodos();
}

function deleteTodo(index) {
  todos.splice(index, 1);
  saveTodos();
  renderTodos();
}

todoForm.addEventListener("submit", addTodo);

renderTodos();
  </script>
</html>
